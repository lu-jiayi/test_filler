current_list = 3;
var order = 1;
all_stimuli = [{"item":101,"block":1,"list":1,"condition":"FILL","Context":"The police officer believes the claim that the bystanders witnessed the traffic accident.","Target":"Who believes the claim that the bystanders witnessed the traffic accident?","Presented_sentence":"Context: The police officer believes the claim that the bystanders witnessed the traffic accident.<p> Target: <b> Who believes the claim that the bystanders witnessed the traffic accident? <\/b>"},{"item":102,"block":2,"list":1,"condition":"FILL","Context":"The customer believed the claim that the waiter mixed up all the orders.","Target":"Who believed the claim that the waiter mixed up all the orders?","Presented_sentence":"Context: The customer believed the claim that the waiter mixed up all the orders.<p> Target: <b> Who believed the claim that the waiter mixed up all the orders? <\/b>"},{"item":103,"block":3,"list":1,"condition":"FILL","Context":"The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.","Target":"Who believes the claim that the reporter hid in the bushes to photograph her new house?","Presented_sentence":"Context: The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.<p> Target: <b> Who believes the claim that the reporter hid in the bushes to photograph her new house? <\/b>"},{"item":104,"block":4,"list":1,"condition":"FILL","Context":"The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.","Target":"Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire?","Presented_sentence":"Context: The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.<p> Target: <b> Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire? <\/b>"},{"item":105,"block":5,"list":1,"condition":"FILL","Context":"The suspect wonders whether the witness told the detectives what happened last night.","Target":"Who wonders whether the witness told the detectives what happened last night?","Presented_sentence":"Context: The suspect wonders whether the witness told the detectives what happened last night.<p> Target: <b> Who wonders whether the witness told the detectives what happened last night? <\/b>"},{"item":106,"block":6,"list":1,"condition":"FILL","Context":"The student wondered whether the teacher would bring a box of chocalate to class the next day.","Target":"Who wondered whether the teacher would bring a box of chocalate to class the next day?","Presented_sentence":"Context: The student wondered whether the teacher would bring a box of chocalate to class the next day.<p> Target: <b> Who wondered whether the teacher would bring a box of chocalate to class the next day? <\/b>"},{"item":107,"block":7,"list":1,"condition":"FILL","Context":"The inspector wonders whether the engineer pressed a button to activate the new machine.","Target":"Who wonders whether the engineer pressed a button to activate the new machine?","Presented_sentence":"Context: The inspector wonders whether the engineer pressed a button to activate the new machine.<p> Target: <b> Who wonders whether the engineer pressed a button to activate the new machine? <\/b>"},{"item":108,"block":8,"list":1,"condition":"FILL","Context":"The guests wondered whether vegetarian dishes will be served at the dinner party.","Target":"Who wondered whether vegetarian dishes will be served at the dinner party?","Presented_sentence":"Context: The guests wondered whether vegetarian dishes will be served at the dinner party.<p> Target: <b> Who wondered whether vegetarian dishes will be served at the dinner party? <\/b>"},{"item":109,"block":9,"list":1,"condition":"FILL","Context":"The patient thinks that the doctor decided not to treat the mysterious condition.","Target":"Who thinks that the doctor decided not to treat the mysterious condition?","Presented_sentence":"Context: The patient thinks that the doctor decided not to treat the mysterious condition.<p> Target: <b> Who thinks that the doctor decided not to treat the mysterious condition? <\/b>"},{"item":110,"block":10,"list":1,"condition":"FILL","Context":"The editor thinks that the journalist should be held responsible for the typos in the article.","Target":"Who thinks that the journalist should be held responsible for the typos in the article?","Presented_sentence":"Context: The editor thinks that the journalist should be held responsible for the typos in the article.<p> Target: <b> Who thinks that the journalist should be held responsible for the typos in the article? <\/b>"},{"item":111,"block":11,"list":1,"condition":"FILL","Context":"The soldier thought the general should order his troops to retreat.","Target":"Who did the soldier think should order his troops to retreat?","Presented_sentence":"Context: The soldier thought the general should order his troops to retreat.<p> Target: <b> Who did the soldier think should order his troops to retreat? <\/b>"},{"item":112,"block":12,"list":1,"condition":"FILL","Context":"The soccer player thinks the manager will be fired by the club chairman.","Target":"Who does the soccer player thinks will be fired by the club chairman?","Presented_sentence":"Context: The soccer player thinks the manager will be fired by the club chairman.<p> Target: <b> Who does the soccer player thinks will be fired by the club chairman? <\/b>"},{"item":113,"block":13,"list":1,"condition":"FILL","Context":"The chef believes that the restaurant owner is planning to open a new branch.","Target":"What does the chef believe that the restaurant owner is planning to open?","Presented_sentence":"Context: The chef believes that the restaurant owner is planning to open a new branch.<p> Target: <b> What does the chef believe that the restaurant owner is planning to open? <\/b>"},{"item":114,"block":14,"list":1,"condition":"FILL","Context":"The banker believed that the customer took out a loan to purchase a new car.","Target":"What did the banker believe that the customer took out a loan to purchase?","Presented_sentence":"Context: The banker believed that the customer took out a loan to purchase a new car.<p> Target: <b> What did the banker believe that the customer took out a loan to purchase? <\/b>"},{"item":115,"block":15,"list":1,"condition":"FILL","Context":"The composer thinks that the violinist has three extra tickets to the concert.","Target":"What does the composer think that the violinist has three extra tickets to?","Presented_sentence":"Context: The composer thinks that the violinist has three extra tickets to the concert.<p> Target: <b> What does the composer think that the violinist has three extra tickets to? <\/b>"},{"item":101,"block":1,"list":2,"condition":"FILL","Context":"The police officer believes the claim that the bystanders witnessed the traffic accident.","Target":"Who believes the claim that the bystanders witnessed the traffic accident?","Presented_sentence":"Context: The police officer believes the claim that the bystanders witnessed the traffic accident.<p> Target: <b> Who believes the claim that the bystanders witnessed the traffic accident? <\/b>"},{"item":102,"block":2,"list":2,"condition":"FILL","Context":"The customer believed the claim that the waiter mixed up all the orders.","Target":"Who believed the claim that the waiter mixed up all the orders?","Presented_sentence":"Context: The customer believed the claim that the waiter mixed up all the orders.<p> Target: <b> Who believed the claim that the waiter mixed up all the orders? <\/b>"},{"item":103,"block":3,"list":2,"condition":"FILL","Context":"The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.","Target":"Who believes the claim that the reporter hid in the bushes to photograph her new house?","Presented_sentence":"Context: The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.<p> Target: <b> Who believes the claim that the reporter hid in the bushes to photograph her new house? <\/b>"},{"item":104,"block":4,"list":2,"condition":"FILL","Context":"The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.","Target":"Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire?","Presented_sentence":"Context: The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.<p> Target: <b> Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire? <\/b>"},{"item":105,"block":5,"list":2,"condition":"FILL","Context":"The suspect wonders whether the witness told the detectives what happened last night.","Target":"Who wonders whether the witness told the detectives what happened last night?","Presented_sentence":"Context: The suspect wonders whether the witness told the detectives what happened last night.<p> Target: <b> Who wonders whether the witness told the detectives what happened last night? <\/b>"},{"item":106,"block":6,"list":2,"condition":"FILL","Context":"The student wondered whether the teacher would bring a box of chocalate to class the next day.","Target":"Who wondered whether the teacher would bring a box of chocalate to class the next day?","Presented_sentence":"Context: The student wondered whether the teacher would bring a box of chocalate to class the next day.<p> Target: <b> Who wondered whether the teacher would bring a box of chocalate to class the next day? <\/b>"},{"item":107,"block":7,"list":2,"condition":"FILL","Context":"The inspector wonders whether the engineer pressed a button to activate the new machine.","Target":"Who wonders whether the engineer pressed a button to activate the new machine?","Presented_sentence":"Context: The inspector wonders whether the engineer pressed a button to activate the new machine.<p> Target: <b> Who wonders whether the engineer pressed a button to activate the new machine? <\/b>"},{"item":108,"block":8,"list":2,"condition":"FILL","Context":"The guests wondered whether vegetarian dishes will be served at the dinner party.","Target":"Who wondered whether vegetarian dishes will be served at the dinner party?","Presented_sentence":"Context: The guests wondered whether vegetarian dishes will be served at the dinner party.<p> Target: <b> Who wondered whether vegetarian dishes will be served at the dinner party? <\/b>"},{"item":109,"block":9,"list":2,"condition":"FILL","Context":"The patient thinks that the doctor decided not to treat the mysterious condition.","Target":"Who thinks that the doctor decided not to treat the mysterious condition?","Presented_sentence":"Context: The patient thinks that the doctor decided not to treat the mysterious condition.<p> Target: <b> Who thinks that the doctor decided not to treat the mysterious condition? <\/b>"},{"item":110,"block":10,"list":2,"condition":"FILL","Context":"The editor thinks that the journalist should be held responsible for the typos in the article.","Target":"Who thinks that the journalist should be held responsible for the typos in the article?","Presented_sentence":"Context: The editor thinks that the journalist should be held responsible for the typos in the article.<p> Target: <b> Who thinks that the journalist should be held responsible for the typos in the article? <\/b>"},{"item":111,"block":11,"list":2,"condition":"FILL","Context":"The soldier thought the general should order his troops to retreat.","Target":"Who did the soldier think should order his troops to retreat?","Presented_sentence":"Context: The soldier thought the general should order his troops to retreat.<p> Target: <b> Who did the soldier think should order his troops to retreat? <\/b>"},{"item":112,"block":12,"list":2,"condition":"FILL","Context":"The soccer player thinks the manager will be fired by the club chairman.","Target":"Who does the soccer player thinks will be fired by the club chairman?","Presented_sentence":"Context: The soccer player thinks the manager will be fired by the club chairman.<p> Target: <b> Who does the soccer player thinks will be fired by the club chairman? <\/b>"},{"item":113,"block":13,"list":2,"condition":"FILL","Context":"The chef believes that the restaurant owner is planning to open a new branch.","Target":"What does the chef believe that the restaurant owner is planning to open?","Presented_sentence":"Context: The chef believes that the restaurant owner is planning to open a new branch.<p> Target: <b> What does the chef believe that the restaurant owner is planning to open? <\/b>"},{"item":114,"block":14,"list":2,"condition":"FILL","Context":"The banker believed that the customer took out a loan to purchase a new car.","Target":"What did the banker believe that the customer took out a loan to purchase?","Presented_sentence":"Context: The banker believed that the customer took out a loan to purchase a new car.<p> Target: <b> What did the banker believe that the customer took out a loan to purchase? <\/b>"},{"item":115,"block":15,"list":2,"condition":"FILL","Context":"The composer thinks that the violinist has three extra tickets to the concert.","Target":"What does the composer think that the violinist has three extra tickets to?","Presented_sentence":"Context: The composer thinks that the violinist has three extra tickets to the concert.<p> Target: <b> What does the composer think that the violinist has three extra tickets to? <\/b>"},{"item":101,"block":1,"list":3,"condition":"FILL","Context":"The police officer believes the claim that the bystanders witnessed the traffic accident.","Target":"Who believes the claim that the bystanders witnessed the traffic accident?","Presented_sentence":"Context: The police officer believes the claim that the bystanders witnessed the traffic accident.<p> Target: <b> Who believes the claim that the bystanders witnessed the traffic accident? <\/b>"},{"item":102,"block":2,"list":3,"condition":"FILL","Context":"The customer believed the claim that the waiter mixed up all the orders.","Target":"Who believed the claim that the waiter mixed up all the orders?","Presented_sentence":"Context: The customer believed the claim that the waiter mixed up all the orders.<p> Target: <b> Who believed the claim that the waiter mixed up all the orders? <\/b>"},{"item":103,"block":3,"list":3,"condition":"FILL","Context":"The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.","Target":"Who believes the claim that the reporter hid in the bushes to photograph her new house?","Presented_sentence":"Context: The celebrity believes the claim that the reporter hid in the bushes to photograph her new house.<p> Target: <b> Who believes the claim that the reporter hid in the bushes to photograph her new house? <\/b>"},{"item":104,"block":4,"list":3,"condition":"FILL","Context":"The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.","Target":"Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire?","Presented_sentence":"Context: The mayor believed the claim that the fireman had to smash a window to gain entrance to the house on fire.<p> Target: <b> Who believed the claim that the fireman had to smash a window to gain entrance to the house on fire? <\/b>"},{"item":105,"block":5,"list":3,"condition":"FILL","Context":"The suspect wonders whether the witness told the detectives what happened last night.","Target":"Who wonders whether the witness told the detectives what happened last night?","Presented_sentence":"Context: The suspect wonders whether the witness told the detectives what happened last night.<p> Target: <b> Who wonders whether the witness told the detectives what happened last night? <\/b>"},{"item":106,"block":6,"list":3,"condition":"FILL","Context":"The student wondered whether the teacher would bring a box of chocalate to class the next day.","Target":"Who wondered whether the teacher would bring a box of chocalate to class the next day?","Presented_sentence":"Context: The student wondered whether the teacher would bring a box of chocalate to class the next day.<p> Target: <b> Who wondered whether the teacher would bring a box of chocalate to class the next day? <\/b>"},{"item":107,"block":7,"list":3,"condition":"FILL","Context":"The inspector wonders whether the engineer pressed a button to activate the new machine.","Target":"Who wonders whether the engineer pressed a button to activate the new machine?","Presented_sentence":"Context: The inspector wonders whether the engineer pressed a button to activate the new machine.<p> Target: <b> Who wonders whether the engineer pressed a button to activate the new machine? <\/b>"},{"item":108,"block":8,"list":3,"condition":"FILL","Context":"The guests wondered whether vegetarian dishes will be served at the dinner party.","Target":"Who wondered whether vegetarian dishes will be served at the dinner party?","Presented_sentence":"Context: The guests wondered whether vegetarian dishes will be served at the dinner party.<p> Target: <b> Who wondered whether vegetarian dishes will be served at the dinner party? <\/b>"},{"item":109,"block":9,"list":3,"condition":"FILL","Context":"The patient thinks that the doctor decided not to treat the mysterious condition.","Target":"Who thinks that the doctor decided not to treat the mysterious condition?","Presented_sentence":"Context: The patient thinks that the doctor decided not to treat the mysterious condition.<p> Target: <b> Who thinks that the doctor decided not to treat the mysterious condition? <\/b>"},{"item":110,"block":10,"list":3,"condition":"FILL","Context":"The editor thinks that the journalist should be held responsible for the typos in the article.","Target":"Who thinks that the journalist should be held responsible for the typos in the article?","Presented_sentence":"Context: The editor thinks that the journalist should be held responsible for the typos in the article.<p> Target: <b> Who thinks that the journalist should be held responsible for the typos in the article? <\/b>"},{"item":111,"block":11,"list":3,"condition":"FILL","Context":"The soldier thought the general should order his troops to retreat.","Target":"Who did the soldier think should order his troops to retreat?","Presented_sentence":"Context: The soldier thought the general should order his troops to retreat.<p> Target: <b> Who did the soldier think should order his troops to retreat? <\/b>"},{"item":112,"block":12,"list":3,"condition":"FILL","Context":"The soccer player thinks the manager will be fired by the club chairman.","Target":"Who does the soccer player thinks will be fired by the club chairman?","Presented_sentence":"Context: The soccer player thinks the manager will be fired by the club chairman.<p> Target: <b> Who does the soccer player thinks will be fired by the club chairman? <\/b>"},{"item":113,"block":13,"list":3,"condition":"FILL","Context":"The chef believes that the restaurant owner is planning to open a new branch.","Target":"What does the chef believe that the restaurant owner is planning to open?","Presented_sentence":"Context: The chef believes that the restaurant owner is planning to open a new branch.<p> Target: <b> What does the chef believe that the restaurant owner is planning to open? <\/b>"},{"item":114,"block":14,"list":3,"condition":"FILL","Context":"The banker believed that the customer took out a loan to purchase a new car.","Target":"What did the banker believe that the customer took out a loan to purchase?","Presented_sentence":"Context: The banker believed that the customer took out a loan to purchase a new car.<p> Target: <b> What did the banker believe that the customer took out a loan to purchase? <\/b>"},{"item":115,"block":15,"list":3,"condition":"FILL","Context":"The composer thinks that the violinist has three extra tickets to the concert.","Target":"What does the composer think that the violinist has three extra tickets to?","Presented_sentence":"Context: The composer thinks that the violinist has three extra tickets to the concert.<p> Target: <b> What does the composer think that the violinist has three extra tickets to? <\/b>"}];

ungram_control1 = {"item":991,"block":991,"list":99,"condition":"UNGRAM_old","Presented_sentence":"Context: The priest of the local church saw a man sleeping under the bridge.  <p> Target: <b> What did the priest see that man was the sleeping under a bridge? <\/b>"}

ungram_control2 = {"item":992,"block":992,"list":99,"condition":"UNGRAM_old","Presented_sentence":"Context: The student wonders whether the manager of the supermarket will take him seriously. <p> Target: <b> Who does the student wonder was he seriously taken by the supermarket of? <\/b>"}

ungram_control3 = {"item":993,"block":993,"list":99,"condition":"UNGRAM_old","Presented_sentence":"Context: The team of researchers think that the government should provide them with more research funds. <p> Target: <b> What do the team researchers think of that should be by the provided government with more? <\/b>"}

ungram_control4 = {"item":994,"block":994,"list":99,"condition":"UNGRAM_old","Presented_sentence":"Context: The TV host acknowledged the possibility that the company might file for bankruptcy. <p> Target: <b> Who did the TV host acknowledge that the possibility company for might the file bankruptcy by? <\/b>"}


//ungram_control5 = {"item":991,"block":991,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The priest of the local church saw a man sleeping under the bridge.  <p> Target: <b> What did the driver see that giant was stood city a van? <\/b>"}

//ungram_control6 = {"item":992,"block":992,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The student wonders whether the manager of the supermarket will take him seriously. <p> Target: <b> Who does the bottle wonder was it absolutely shock the by hospital of? <\/b>"}

//ungram_control7 = {"item":993,"block":993,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The team of researchers think that the government should provide them with more research funds. <p> Target: <b> What do the farmers team think that of should by be the given governor less with? <\/b>"}

//ungram_control8 = {"item":994,"block":994,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The TV host acknowledged the possibility that the company might file for bankruptcy. <p> Target: <b> Who did the radio acknowledge that the impossible firm might for the document robbery on? <\/b>"}


ungram_control5 = {"item":991,"block":991,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The priest of the local church saw a man sleeping under the bridge.  <p> Target: <b> What bridge the under saw churche local the of did priest the? <\/b>"}

ungram_control6 = {"item":992,"block":992,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The student wonders whether the manager of the supermarket will take him seriously. <p> Target: <b> Who seriouly him take will supermarket the of manager the whether wonders? <\/b>"}

ungram_control7 = {"item":993,"block":993,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The team of researchers think that the government should provide them with more research funds. <p> Target: <b> What more with them provide should government the that think researchers do? <\/b>"}

ungram_control8 = {"item":994,"block":994,"list":99,"condition":"UNGRAM_new","Presented_sentence":"Context: The TV host acknowledged the possibility that the company might file for bankruptcy. <p> Target: <b> Who bankruptcy for file might company the that possibility the acknwoledged? <\/b>"}


all_stimuli = all_stimuli.filter(function (e){
  return e.list == current_list;
});

var shuffle = function (array) {

	var currentIndex = array.length;
	var temporaryValue, randomIndex;

	// While there remain elements to shuffle...
	while (0 !== currentIndex) {
		// Pick a remaining element...
		randomIndex = Math.floor(Math.random() * currentIndex);
		currentIndex -= 1;

		// And swap it with the current element.
		temporaryValue = array[currentIndex];
		array[currentIndex] = array[randomIndex];
		array[randomIndex] = temporaryValue;
	}

	return array;

};

block_1 = all_stimuli.filter(function (e) {
  return e.block == 1;
});
block_2 = all_stimuli.filter(function (e) {
  return e.block == 2;
});
block_3 = all_stimuli.filter(function (e) {
  return e.block == 3;
});
block_4 = all_stimuli.filter(function (e) {
  return e.block == 4;
});
block_5 = all_stimuli.filter(function (e) {
  return e.block == 5;
});
block_6 = all_stimuli.filter(function (e) {
  return e.block == 6;
});
block_7 = all_stimuli.filter(function (e) {
  return e.block == 7;
});
block_8 = all_stimuli.filter(function (e) {
  return e.block == 8;
});


block_1 = shuffle(block_1);
block_1.push(ungram_control1);
block_2 = shuffle(block_2);
block_2.push(ungram_control2);
block_3 = shuffle(block_3);
block_3.push(ungram_control3);
block_4 = shuffle(block_4);
block_4.push(ungram_control4);
block_5 = shuffle(block_5);
block_5.push(ungram_control5);
block_6 = shuffle(block_6);
block_6.push(ungram_control6);
block_7 = shuffle(block_7);
block_7.push(ungram_control7);
block_8 = shuffle(block_8);
block_8.push(ungram_control8);

shuffled_blocks = shuffle([block_1, block_2, block_3, block_4, block_5, block_6, block_7, block_8]);



latin_squared = shuffled_blocks.flat();

function make_slides(f) {
  var   slides = {};  
  slides.i0 = slide({
     name : "i0",
     start: function() {
      exp.startT = Date.now();
     }
  });

  slides.instructions = slide({
    name : "instructions",
    button : function() {
      exp.go(); //use exp.go() if and only if there is no "present" data.
    }
  });

  slides.single_trial = slide({
    name: "single_trial",
    start: function() {
      $(".err").hide();
      $(".display_condition").html("You are in " + exp.condition + ".");
    },
    button : function() {
      response = $("#text_response").val();
      if (response.length == 0) {
        $(".err").show();
      } else {
        exp.data_trials.push({
          "trial_type" : "single_trial",
          "response" : response
        });
        exp.go(); //make sure this is at the *end*, after you log your data
      }
    },
  });

  slides.practice_slider = slide({
    name : "practice_slider",

    /* trial information for this block
     (the variable 'stim' will change between each of these values,
      and for each of these, present_handle will be run.) */
    present : [{"a": 1}],
    //this gets run only at the beginning of the block
    present_handle : function(stim) {
      $(".err").hide();
      this.stim = stim;
      $(".prompt").html("Context: The boy saw an apple on the table. <p>  Target: <b> What did the boy see on the table? <\/b>");
      this.init_sliders();
      exp.sliderPost = null; //erase current slider value
    },
    button : function() {
      if (exp.sliderPost == null) {
        $(".err").show();
      } else {
        this.log_responses();
        /* use _stream.apply(this); if and only if there is
        "present" data. (and only *after* responses are logged) */
        _stream.apply(this);
      }
    },
    init_sliders : function() {
      utils.make_slider("#practice_slider_1", function(event, ui) {
        exp.sliderPost = ui.value;
      });
    },
    log_responses : function() {
      exp.data_trials.push({
        "response" : exp.sliderPost,
        "condition" : "practice_good",
        "block_sequence": "practice",
        "item_number": "practice_good",
        "list_number": "practice",
        "trial_sequence_total": 0
      });

    }
  });

  slides.post_practice_1 = slide({
    name : "post_practice_1",
    button : function() {
      exp.go(); //use exp.go() if and only if there is no "present" data.
    }
  });

  slides.practice_slider_bad = slide({
    name : "practice_slider_bad",

    /* trial information for this block
     (the variable 'stim' will change between each of these values,
      and for each of these, present_handle will be run.) */
    present : [1],

  
    //this gets run only at the beginning of the block
    present_handle : function(stim) {
      $(".err").hide();
      $(".prompt").html("Context: The girl slept under the bed. <p>  Target: <b> Who the bed was slept under? <\/b>");
      this.init_sliders();
      exp.sliderPost = null; //erase current slider value
    },
    button : function() {
      if (exp.sliderPost == null) {
        $(".err").show();
      } else {
        this.log_responses();
        /* use _stream.apply(this); if and only if there is
        "present" data. (and only *after* responses are logged) */
        _stream.apply(this);
      }
    },
    init_sliders : function() {
      utils.make_slider("#practice_slider_2", function(event, ui) {
        exp.sliderPost = ui.value;
        
      });
    },
    log_responses : function() {
      exp.data_trials.push({
        "response" : exp.sliderPost,
        "condition" : "practice_bad",
        "block_sequence": "practice",
        "item_number": "practice_bad",
        "list_number": "practice",
        "trial_sequence_total": 0
      });

    }
  });

  slides.post_practice_2 = slide({
    name : "post_practice_2",
    button : function() {
      exp.go(); //use exp.go() if and only if there is no "present" data.
    }
  });

  slides.last_reminder = slide({
    name : "last_reminder",
    button : function() {
      exp.go(); //use exp.go() if and only if there is no "present" data.
    }
    
  });

  slides.one_slider = slide({
    name : "one_slider",

    /* trial information for this block
     (the variable 'stim' will change between each of these values,
      and for each of these, present_handle will be run.) */
    present : latin_squared,
    
    //this gets run only at the beginning of the block
    present_handle : function(stim) {
      $(".err").hide();
      this.stim = stim; //I like to store this information in the slide so I can record it later.
      $(".prompt").html(stim.Presented_sentence);
      this.init_sliders()
      exp.sliderPost = null; //erase current slider value
    },

    button : function() {
      if (exp.sliderPost == null) {
        $(".err").show();
      } else {
        this.log_responses();

        /* use _stream.apply(this); if and only if there is
        "present" data. (and only *after* responses are logged) */
        _stream.apply(this);
      }
    },

    init_sliders : function() {
      utils.make_slider("#single_slider", function(event, ui) {
        exp.sliderPost = ui.value;
      });
    },

    log_responses : function() {
      exp.data_trials.push({
        "response" : exp.sliderPost,
        "condition" : this.stim.condition,
        "item_number": this.stim.item,
        "list_number": this.stim.list,
        "trial_sequence_total": order
      });
      order = order + 1;
    }
  });



  slides.subj_info =  slide({
    name : "subj_info",
    submit : function(e){
      //if (e.preventDefault) e.preventDefault(); // I don't know what this means.
      exp.subj_data = {
        language : $("#language").val(),
        enjoyment : $("#enjoyment").val(),
        asses : $('input[name="assess"]:checked').val(),
        age : $("#age").val(),
        gender : $("#gender").val(),
        education : $("#education").val(),
        comments : $("#comments").val(),
        problems: $("#problems").val(),
        fairprice: $("#fairprice").val()
      };
      exp.go(); //use exp.go() if and only if there is no "present" data.
    }
  });

  slides.thanks = slide({
    name : "thanks",
    start : function() {
      exp.data= {
          "trials" : exp.data_trials,
          "catch_trials" : exp.catch_trials,
          "system" : exp.system,
          "condition" : exp.condition,
          "subject_information" : exp.subj_data,
          "time_in_minutes" : (Date.now() - exp.startT)/60000
      };
      setTimeout(function() {turk.submit(exp.data);}, 1000);
    }
  });

  return slides;
}

/// init ///
function init() {
  exp.trials = [];
  exp.catch_trials = [];
  //exp.condition = _.sample(["condition 1", "condition 2"]); //can randomize between subject conditions here
  exp.system = {
      Browser : BrowserDetect.browser,
      OS : BrowserDetect.OS,
      screenH: screen.height,
      screenUH: exp.height,
      screenW: screen.width,
      screenUW: exp.width
    };
  //blocks of the experiment:
  exp.structure=["i0", "instructions", "practice_slider", "post_practice_1", "practice_slider_bad", "post_practice_2", "last_reminder", "one_slider", 'subj_info', 'thanks'];

  exp.data_trials = [];
  //make corresponding slides:
  exp.slides = make_slides(exp);

  exp.nQs = utils.get_exp_length(); //this does not work if there are stacks of stims (but does work for an experiment with this structure)
                    //relies on structure and slides being defined

  $('.slide').hide(); //hide everything

  //make sure turkers have accepted HIT (or you're not in mturk)
  $("#start_button").click(function() {
    if (turk.previewMode) {
      $("#mustaccept").show();
    } else {
      $("#start_button").click(function() {$("#mustaccept").show();});
      exp.go();
    }
  });

  exp.go(); //show first slide
}
